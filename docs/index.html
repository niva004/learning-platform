<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Mastery Academy - Naucz siƒô tradingu od ekspert√≥w</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìà</text></svg>">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --danger: #ef4444;
            --warning: #f59e0b;
            --gold: #fbbf24;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Anti-screenshot protection */
        .protected-content {
            position: relative;
        }

        @media print {
            body * {
                display: none !important;
            }
            body::after {
                content: "Drukowanie jest zablokowane dla ochrony tre≈õci.";
                display: block;
                font-size: 24px;
                text-align: center;
                padding: 50px;
            }
        }

        /* Navigation */
        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .nav-links a, .nav-links button {
            padding: 0.5rem 1rem;
            text-decoration: none;
            color: var(--dark);
            border-radius: 8px;
            transition: all 0.3s;
            border: none;
            background: none;
            font-size: 1rem;
            cursor: pointer;
        }

        .nav-links a:hover, .nav-links button:hover {
            background: var(--light);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 6rem 2rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        /* Courses Section */
        .section {
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 3rem;
            color: var(--dark);
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .course-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .course-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .course-image {
            height: 200px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
        }

        .course-image.advanced {
            background: linear-gradient(135deg, var(--gold) 0%, var(--warning) 100%);
        }

        .course-content {
            padding: 1.5rem;
        }

        .course-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .badge-beginner {
            background: #dbeafe;
            color: var(--primary);
        }

        .badge-advanced {
            background: #fef3c7;
            color: var(--warning);
        }

        .course-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .course-description {
            color: var(--gray);
            margin-bottom: 1rem;
        }

        .course-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .course-price {
            font-size: 1.75rem;
            font-weight: bold;
            color: var(--primary);
        }

        .course-price span {
            font-size: 1rem;
            color: var(--gray);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            width: 90%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-error {
            color: var(--danger);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .form-footer {
            margin-top: 1.5rem;
            text-align: center;
        }

        .form-footer a {
            color: var(--primary);
            cursor: pointer;
        }

        /* Dashboard */
        .page {
            display: none;
            min-height: calc(100vh - 80px);
        }

        .page.active {
            display: block;
        }

        .dashboard-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 3rem 2rem;
        }

        .dashboard-header h1 {
            max-width: 1200px;
            margin: 0 auto;
        }

        .dashboard-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stat-card h3 {
            color: var(--gray);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* Payment Methods */
        .payment-methods {
            display: grid;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-method:hover {
            border-color: var(--primary);
        }

        .payment-method.selected {
            border-color: var(--primary);
            background: #eff6ff;
        }

        .payment-method input {
            display: none;
        }

        .payment-icon {
            font-size: 2rem;
            width: 50px;
            text-align: center;
        }

        .payment-info h4 {
            font-size: 1rem;
        }

        .payment-info p {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Admin Panel */
        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 1rem;
        }

        .admin-tab {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            font-size: 1rem;
            cursor: pointer;
            color: var(--gray);
            border-bottom: 2px solid transparent;
            margin-bottom: -1rem;
            padding-bottom: calc(1rem + 2px);
        }

        .admin-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .data-table {
            width: 100%;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table th {
            background: var(--light);
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f8fafc;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-active {
            background: #d1fae5;
            color: #059669;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        /* Video Player */
        .video-container {
            position: relative;
            background: black;
            border-radius: 12px;
            overflow: hidden;
            aspect-ratio: 16/9;
        }

        .video-player {
            width: 100%;
            height: 100%;
        }

        .video-watermark {
            position: absolute;
            color: rgba(255,255,255,0.3);
            font-size: 0.875rem;
            pointer-events: none;
            padding: 0.5rem;
            transition: all 5s ease;
        }

        .video-locked {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .video-locked h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        /* Lesson List */
        .lesson-list {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .lesson-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: background 0.3s;
        }

        .lesson-item:hover {
            background: #f8fafc;
        }

        .lesson-item.active {
            background: #eff6ff;
            border-left: 3px solid var(--primary);
        }

        .lesson-item.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .lesson-number {
            width: 32px;
            height: 32px;
            background: var(--light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--primary);
        }

        .lesson-item.completed .lesson-number {
            background: var(--secondary);
            color: white;
        }

        .lesson-info {
            flex: 1;
        }

        .lesson-title {
            font-weight: 600;
        }

        .lesson-duration {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }

        .footer a {
            color: var(--primary);
        }

        /* Alert */
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .alert-success {
            background: #d1fae5;
            color: #059669;
        }

        .alert-error {
            background: #fee2e2;
            color: #dc2626;
        }

        .alert-info {
            background: #dbeafe;
            color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .courses-grid {
                grid-template-columns: 1fr;
            }

            .nav-links {
                gap: 0.5rem;
            }

            .navbar-content {
                flex-wrap: wrap;
            }
        }

        /* Blur protection on visibility change */
        .blur-protection {
            filter: blur(20px);
            pointer-events: none;
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 3000;
        }

        .toast {
            background: var(--dark);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="#" class="logo" onclick="showPage('home')">
                <span>üìà</span> Trading Mastery Academy
            </a>
            <div class="nav-links" id="navLinks">
                <a href="#" onclick="showPage('home')">Strona Glowna</a>
                <a href="#courses-section" onclick="showPage('home')">Kursy</a>
                <button class="btn btn-outline" onclick="showModal('login')">Zaloguj sie</button>
                <button class="btn btn-primary" onclick="showModal('register')">Zarejestruj sie</button>
            </div>
            <div class="nav-links" id="navLinksLoggedIn" style="display: none;">
                <a href="#" onclick="showPage('home')">Strona Glowna</a>
                <a href="#" onclick="showPage('dashboard')">Panel</a>
                <a href="#" onclick="showPage('admin')" id="adminLink" style="display: none;">Admin</a>
                <span id="userEmail" style="color: var(--gray);"></span>
                <button class="btn btn-outline" onclick="logout()">Wyloguj</button>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <div class="page active" id="page-home">
        <!-- Hero -->
        <section class="hero">
            <h1>Zosta≈Ñ Profesjonalnym Traderem</h1>
            <p>Naucz sie tradingu od doswiadczonego eksperta z ponad 10-letnim stazem na rynkach finansowych. Od podstaw do zaawansowanych strategii.</p>
            <button class="btn btn-secondary" onclick="document.getElementById('courses-section').scrollIntoView({behavior: 'smooth'})">
                Zobacz Kursy
            </button>
        </section>

        <!-- Features -->
        <section class="section">
            <h2 class="section-title">Dlaczego warto sie uczyƒá z nami?</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Wideo Lekcje</h3>
                    <div class="value">50+</div>
                </div>
                <div class="stat-card">
                    <h3>Godzin Materialu</h3>
                    <div class="value">30+</div>
                </div>
                <div class="stat-card">
                    <h3>Zadowolonych Kursantow</h3>
                    <div class="value">500+</div>
                </div>
                <div class="stat-card">
                    <h3>Lat Doswiadczenia</h3>
                    <div class="value">10+</div>
                </div>
            </div>
        </section>

        <!-- Courses -->
        <section class="section" id="courses-section">
            <h2 class="section-title">Nasze Kursy</h2>
            <div class="courses-grid">
                <!-- Basic Course -->
                <div class="course-card">
                    <div class="course-image">üìä</div>
                    <div class="course-content">
                        <span class="course-badge badge-beginner">Podstawowy</span>
                        <h3 class="course-title">Trading od Podstaw</h3>
                        <p class="course-description">
                            Idealny kurs dla poczatkujacych. Poznasz podstawy analizy technicznej,
                            zarzadzania ryzykiem i psychologii tradingu.
                        </p>
                        <div class="course-meta">
                            <span>üìö 12 lekcji</span>
                            <span>‚è±Ô∏è 8 godzin</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div class="course-price">299 PLN</div>
                            <button class="btn btn-primary" onclick="showCourseDetails('basic')">Zobacz Wiecej</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Course -->
                <div class="course-card">
                    <div class="course-image advanced">üöÄ</div>
                    <div class="course-content">
                        <span class="course-badge badge-advanced">Zaawansowany</span>
                        <h3 class="course-title">Zaawansowane Strategie</h3>
                        <p class="course-description">
                            Dla tych, kt√≥rzy chca wyjsc na wyzszy poziom. Zaawansowana analiza,
                            strategie day tradingu i scalping.
                        </p>
                        <div class="course-meta">
                            <span>üìö 20 lekcji</span>
                            <span>‚è±Ô∏è 15 godzin</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div class="course-price">599 PLN</div>
                            <button class="btn btn-primary" onclick="showCourseDetails('advanced')">Zobacz Wiecej</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 Trading Mastery Academy. Wszelkie prawa zastrzezone.</p>
            <p style="margin-top: 1rem; opacity: 0.7;">Demo version - dla celow demonstracyjnych</p>
        </footer>
    </div>

    <!-- Dashboard Page -->
    <div class="page" id="page-dashboard">
        <div class="dashboard-header">
            <h1>Witaj, <span id="dashboardUserName">Uzytkowniku</span>!</h1>
        </div>
        <div class="dashboard-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Zakupione Kursy</h3>
                    <div class="value" id="purchasedCoursesCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>Ukonczonych Lekcji</h3>
                    <div class="value" id="completedLessonsCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>Twoj Postep</h3>
                    <div class="value" id="progressPercent">0%</div>
                </div>
            </div>

            <h2 style="margin: 2rem 0 1rem;">Twoje Kursy</h2>
            <div class="courses-grid" id="userCourses">
                <div class="alert alert-info">
                    Nie masz jeszcze zadnych kursow. <a href="#" onclick="showPage('home')">Przegladaj kursy</a>
                </div>
            </div>

            <h2 style="margin: 2rem 0 1rem;">Historia Platnosci</h2>
            <table class="data-table" id="paymentHistory">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Kurs</th>
                        <th>Metoda</th>
                        <th>Kwota</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="paymentHistoryBody">
                    <tr>
                        <td colspan="5" style="text-align: center; color: var(--gray);">Brak historii platnosci</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Course Detail Page -->
    <div class="page" id="page-course">
        <div class="dashboard-header" id="courseHeader">
            <h1 id="courseTitle">Kurs</h1>
        </div>
        <div class="dashboard-content">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;" class="course-layout">
                <!-- Video / Preview -->
                <div>
                    <div class="video-container" id="videoContainer">
                        <div class="video-locked" id="videoLocked">
                            <span style="font-size: 4rem;">üîí</span>
                            <h3>Kurs Zablokowany</h3>
                            <p style="margin-bottom: 1rem;">Kup kurs, aby uzyskac dostep do materialow</p>
                            <button class="btn btn-primary" onclick="showModal('payment')">Kup Teraz</button>
                        </div>
                        <video class="video-player" id="videoPlayer" style="display: none;" controls controlsList="nodownload">
                            <source src="" type="video/mp4">
                        </video>
                        <div class="video-watermark" id="videoWatermark"></div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <h3 id="currentLessonTitle">Wybierz lekcje z listy</h3>
                        <p id="currentLessonDescription" style="color: var(--gray); margin-top: 0.5rem;"></p>
                    </div>
                </div>

                <!-- Lesson List -->
                <div>
                    <h3 style="margin-bottom: 1rem;">Lekcje</h3>
                    <div class="lesson-list" id="lessonList">
                        <!-- Lessons will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Page -->
    <div class="page" id="page-admin">
        <div class="dashboard-header">
            <h1>Panel Administratora</h1>
        </div>
        <div class="dashboard-content">
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="switchAdminTab('courses')">Kursy</button>
                <button class="admin-tab" onclick="switchAdminTab('users')">Uzytkownicy</button>
                <button class="admin-tab" onclick="switchAdminTab('payments')">Platnosci</button>
                <button class="admin-tab" onclick="switchAdminTab('settings')">Ustawienia</button>
            </div>

            <!-- Courses Tab -->
            <div id="admin-courses" class="admin-panel-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2>Zarzadzanie Kursami</h2>
                    <button class="btn btn-primary" onclick="showToast('Demo: Dodawanie kursow')">+ Dodaj Kurs</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nazwa</th>
                            <th>Poziom</th>
                            <th>Cena</th>
                            <th>Lekcje</th>
                            <th>Sprzedane</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Trading od Podstaw</td>
                            <td><span class="course-badge badge-beginner">Podstawowy</span></td>
                            <td>299 PLN</td>
                            <td>12</td>
                            <td>156</td>
                            <td>
                                <button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;" onclick="showToast('Demo: Edycja kursu')">Edytuj</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Zaawansowane Strategie</td>
                            <td><span class="course-badge badge-advanced">Zaawansowany</span></td>
                            <td>599 PLN</td>
                            <td>20</td>
                            <td>89</td>
                            <td>
                                <button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;" onclick="showToast('Demo: Edycja kursu')">Edytuj</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Users Tab -->
            <div id="admin-users" class="admin-panel-content" style="display: none;">
                <h2 style="margin-bottom: 1rem;">Uzytkownicy</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Rola</th>
                            <th>Data Rejestracji</th>
                            <th>Zakupione Kursy</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="adminUsersTable">
                        <!-- Users will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Payments Tab -->
            <div id="admin-payments" class="admin-panel-content" style="display: none;">
                <h2 style="margin-bottom: 1rem;">Historia Platnosci</h2>
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <h3>Laczne Przychody</h3>
                        <div class="value">24,750 PLN</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ten Miesiac</h3>
                        <div class="value">4,200 PLN</div>
                    </div>
                    <div class="stat-card">
                        <h3>Sprzedanych Kursow</h3>
                        <div class="value">245</div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Uzytkownik</th>
                            <th>Kurs</th>
                            <th>Metoda</th>
                            <th>Kwota</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="adminPaymentsTable">
                        <!-- Payments will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Settings Tab -->
            <div id="admin-settings" class="admin-panel-content" style="display: none;">
                <h2 style="margin-bottom: 1rem;">Ustawienia Platformy</h2>
                <div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div class="form-group">
                        <label>Nazwa Platformy</label>
                        <input type="text" value="Trading Mastery Academy">
                    </div>
                    <div class="form-group">
                        <label>Email Kontaktowy</label>
                        <input type="email" value="kontakt@tradingacademy.pl">
                    </div>
                    <div class="form-group">
                        <label>Waluta</label>
                        <input type="text" value="PLN" readonly>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" checked> Wlacz rejestracje nowych uzytkownikow
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" checked> Wlacz znak wodny na filmach
                        </label>
                    </div>
                    <button class="btn btn-primary" onclick="showToast('Ustawienia zapisane (demo)')">Zapisz Ustawienia</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="modal-login">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Zaloguj sie</h2>
                <button class="modal-close" onclick="hideModal('login')">&times;</button>
            </div>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" required placeholder="twoj@email.pl">
                </div>
                <div class="form-group">
                    <label>Haslo</label>
                    <input type="password" id="loginPassword" required placeholder="Twoje haslo">
                </div>
                <div class="form-error" id="loginError"></div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Zaloguj sie</button>
                <div class="form-footer">
                    <p>Nie masz konta? <a onclick="hideModal('login'); showModal('register')">Zarejestruj sie</a></p>
                </div>
            </form>
            <div class="alert alert-info" style="margin-top: 1rem;">
                <strong>Demo:</strong><br>
                Admin: admin@demo.pl / admin123<br>
                User: user@demo.pl / user123
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal-overlay" id="modal-register">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Zarejestruj sie</h2>
                <button class="modal-close" onclick="hideModal('register')">&times;</button>
            </div>
            <form onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Imie</label>
                    <input type="text" id="registerName" required placeholder="Twoje imie">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" required placeholder="twoj@email.pl">
                </div>
                <div class="form-group">
                    <label>Haslo</label>
                    <input type="password" id="registerPassword" required minlength="6" placeholder="Min. 6 znakow">
                </div>
                <div class="form-group">
                    <label>Powtorz Haslo</label>
                    <input type="password" id="registerPasswordConfirm" required placeholder="Powtorz haslo">
                </div>
                <div class="form-error" id="registerError"></div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Zarejestruj sie</button>
                <div class="form-footer">
                    <p>Masz juz konto? <a onclick="hideModal('register'); showModal('login')">Zaloguj sie</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal-overlay" id="modal-payment">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Kup Kurs</h2>
                <button class="modal-close" onclick="hideModal('payment')">&times;</button>
            </div>
            <div id="paymentCourseInfo">
                <h3 id="paymentCourseName">Trading od Podstaw</h3>
                <p style="color: var(--gray);" id="paymentCourseDesc">Kurs podstawowy tradingu</p>
                <div class="course-price" style="margin: 1rem 0;" id="paymentCoursePrice">299 PLN</div>
            </div>

            <h4 style="margin-bottom: 0.5rem;">Wybierz metode platnosci:</h4>
            <div class="payment-methods">
                <label class="payment-method" onclick="selectPayment('apple')">
                    <input type="radio" name="payment" value="apple">
                    <div class="payment-icon">üçé</div>
                    <div class="payment-info">
                        <h4>Apple Pay</h4>
                        <p>Szybka platnosc przez Apple</p>
                    </div>
                </label>
                <label class="payment-method" onclick="selectPayment('blik')">
                    <input type="radio" name="payment" value="blik">
                    <div class="payment-icon">üì±</div>
                    <div class="payment-info">
                        <h4>BLIK</h4>
                        <p>Platnosc kodem BLIK</p>
                    </div>
                </label>
                <label class="payment-method" onclick="selectPayment('card')">
                    <input type="radio" name="payment" value="card">
                    <div class="payment-icon">üí≥</div>
                    <div class="payment-info">
                        <h4>Karta Kredytowa/Debetowa</h4>
                        <p>Visa, Mastercard, inne</p>
                    </div>
                </label>
            </div>

            <!-- BLIK Code Input -->
            <div id="blikInput" style="display: none;">
                <div class="form-group">
                    <label>Wprowadz kod BLIK</label>
                    <input type="text" id="blikCode" maxlength="6" pattern="[0-9]{6}" placeholder="000000" style="text-align: center; font-size: 1.5rem; letter-spacing: 0.5rem;">
                </div>
            </div>

            <!-- Card Input -->
            <div id="cardInput" style="display: none;">
                <div class="form-group">
                    <label>Numer Karty</label>
                    <input type="text" id="cardNumber" maxlength="19" placeholder="0000 0000 0000 0000">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label>Data Waznosci</label>
                        <input type="text" id="cardExpiry" maxlength="5" placeholder="MM/RR">
                    </div>
                    <div class="form-group">
                        <label>CVV</label>
                        <input type="text" id="cardCvv" maxlength="4" placeholder="000">
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="processPayment()">
                Zaplac
            </button>
            <p style="text-align: center; margin-top: 1rem; font-size: 0.875rem; color: var(--gray);">
                üîí Platnosc jest bezpieczna i szyfrowana
            </p>
        </div>
    </div>

    <!-- Payment Success Modal -->
    <div class="modal-overlay" id="modal-payment-success">
        <div class="modal" style="text-align: center;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">‚úÖ</div>
            <h2 style="margin-bottom: 1rem;">Platnosc Zakonczona!</h2>
            <p style="color: var(--gray); margin-bottom: 2rem;">Dziekujemy za zakup. Mozesz teraz rozpoczac nauke.</p>
            <button class="btn btn-primary" onclick="hideModal('payment-success'); showPage('course');">
                Przejdz do Kursu
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ===========================================
        // DATABASE (localStorage simulation)
        // ===========================================

        const DB = {
            // Hardcoded demo users
            defaultUsers: [
                {
                    id: 'admin-1',
                    email: 'admin@demo.pl',
                    password: 'admin123',
                    name: 'Administrator',
                    role: 'ADMIN',
                    createdAt: '2024-01-01'
                },
                {
                    id: 'user-1',
                    email: 'user@demo.pl',
                    password: 'user123',
                    name: 'Jan Kowalski',
                    role: 'USER',
                    createdAt: '2024-06-15'
                }
            ],

            // Courses data
            courses: {
                basic: {
                    id: 'basic',
                    name: 'Trading od Podstaw',
                    level: 'BEGINNER',
                    description: 'Idealny kurs dla poczatkujacych. Poznasz podstawy analizy technicznej, zarzadzania ryzykiem i psychologii tradingu.',
                    price: 299,
                    lessons: [
                        { id: 'b1', title: 'Wprowadzenie do tradingu', duration: '15:00', description: 'Poznaj podstawy rynkow finansowych i dowiedz sie czym jest trading.' },
                        { id: 'b2', title: 'Rodzaje rynkow', duration: '20:00', description: 'Forex, akcje, kryptowaluty - poznaj rozne rynki.' },
                        { id: 'b3', title: 'Analiza techniczna - podstawy', duration: '25:00', description: 'Wykresy, swiece japonskie i podstawowe formacje.' },
                        { id: 'b4', title: 'Wsparcia i opory', duration: '18:00', description: 'Jak identyfikowac kluczowe poziomy cenowe.' },
                        { id: 'b5', title: 'Srednie kroczace', duration: '22:00', description: 'Wykorzystanie srednich kroczacych w analizie.' },
                        { id: 'b6', title: 'Wskazniki techniczne', duration: '30:00', description: 'RSI, MACD, Stochastic i inne popularne wskazniki.' },
                        { id: 'b7', title: 'Zarzadzanie ryzykiem', duration: '25:00', description: 'Stop Loss, Take Profit i zarzadzanie kapitatem.' },
                        { id: 'b8', title: 'Psychologia tradingu', duration: '20:00', description: 'Emocje w tradingu i jak nad nimi panowac.' },
                        { id: 'b9', title: 'Tworzenie planu tradingowego', duration: '18:00', description: 'Jak stworzyc skuteczny plan tradingowy.' },
                        { id: 'b10', title: 'Wybor brokera', duration: '15:00', description: 'Na co zwracac uwage przy wyborze brokera.' },
                        { id: 'b11', title: 'Pierwsza transakcja', duration: '20:00', description: 'Praktyczne cwiczenie - otwieranie pierwszej pozycji.' },
                        { id: 'b12', title: 'Podsumowanie i dalsze kroki', duration: '12:00', description: 'Co dalej? Jak kontynuowac nauke tradingu.' }
                    ]
                },
                advanced: {
                    id: 'advanced',
                    name: 'Zaawansowane Strategie',
                    level: 'ADVANCED',
                    description: 'Dla tych, ktorzy chca wyjsc na wyzszy poziom. Zaawansowana analiza, strategie day tradingu i scalping.',
                    price: 599,
                    lessons: [
                        { id: 'a1', title: 'Price Action - zaawansowane', duration: '30:00', description: 'Zaawansowane techniki czytania wykresow.' },
                        { id: 'a2', title: 'Formacje harmoniczne', duration: '35:00', description: 'Gartley, Bat, Butterfly i inne formacje.' },
                        { id: 'a3', title: 'Fale Elliotta', duration: '40:00', description: 'Teoria fal Elliotta w praktyce.' },
                        { id: 'a4', title: 'Fibonacci zaawansowany', duration: '25:00', description: 'Poziomy Fibonacci w zaawansowanej analizie.' },
                        { id: 'a5', title: 'Order Flow i Volume Profile', duration: '35:00', description: 'Analiza przeplywu zlecen i profilu wolumenu.' },
                        { id: 'a6', title: 'Day Trading - strategia', duration: '40:00', description: 'Kompletna strategia day tradingowa.' },
                        { id: 'a7', title: 'Scalping', duration: '30:00', description: 'Szybkie transakcje na niskich interwalach.' },
                        { id: 'a8', title: 'Swing Trading', duration: '35:00', description: 'Strategie na srednie interwaly czasowe.' },
                        { id: 'a9', title: 'Multi-timeframe analysis', duration: '25:00', description: 'Analiza wielointerwalowa.' },
                        { id: 'a10', title: 'Backtesting strategii', duration: '30:00', description: 'Jak testowac strategie na danych historycznych.' },
                        { id: 'a11', title: 'Automatyzacja tradingu', duration: '35:00', description: 'Wprowadzenie do tradingu algorytmicznego.' },
                        { id: 'a12', title: 'Zaawansowane zarzadzanie ryzykiem', duration: '25:00', description: 'Profesjonalne podejscie do ryzyka.' },
                        { id: 'a13', title: 'Psychologia zaawansowana', duration: '30:00', description: 'Mindset profesjonalnego tradera.' },
                        { id: 'a14', title: 'Analiza fundamentalna', duration: '35:00', description: 'Wiadomosci, wydarzenia makroekonomiczne.' },
                        { id: 'a15', title: 'Korelacje miedzy rynkami', duration: '25:00', description: 'Jak rynki wplywaja na siebie nawzajem.' },
                        { id: 'a16', title: 'Budowanie portfela', duration: '30:00', description: 'Dywersyfikacja i alokacja kapitalu.' },
                        { id: 'a17', title: 'Dziennik tradera', duration: '20:00', description: 'Jak prowadzic efektywny dziennik.' },
                        { id: 'a18', title: 'Optymalizacja strategii', duration: '35:00', description: 'Doskonalenie systemu tradingowego.' },
                        { id: 'a19', title: 'Live trading session', duration: '60:00', description: 'Sesja tradingowa na zywo.' },
                        { id: 'a20', title: 'Podsumowanie i plan rozwoju', duration: '25:00', description: 'Dalsze kroki w karierze tradera.' }
                    ]
                }
            },

            // Sample payments for admin view
            samplePayments: [
                { date: '2024-12-28', user: 'jan@example.pl', course: 'Trading od Podstaw', method: 'BLIK', amount: 299, status: 'completed' },
                { date: '2024-12-27', user: 'anna@example.pl', course: 'Zaawansowane Strategie', method: 'Card', amount: 599, status: 'completed' },
                { date: '2024-12-26', user: 'piotr@example.pl', course: 'Trading od Podstaw', method: 'Apple Pay', amount: 299, status: 'completed' },
                { date: '2024-12-25', user: 'maria@example.pl', course: 'Zaawansowane Strategie', method: 'BLIK', amount: 599, status: 'pending' },
            ],

            getUsers() {
                const stored = localStorage.getItem('tm_users');
                if (stored) {
                    const users = JSON.parse(stored);
                    // Ensure default users exist
                    this.defaultUsers.forEach(defaultUser => {
                        if (!users.find(u => u.email === defaultUser.email)) {
                            users.push(defaultUser);
                        }
                    });
                    return users;
                }
                return [...this.defaultUsers];
            },

            saveUsers(users) {
                localStorage.setItem('tm_users', JSON.stringify(users));
            },

            getPurchases() {
                return JSON.parse(localStorage.getItem('tm_purchases') || '[]');
            },

            savePurchases(purchases) {
                localStorage.setItem('tm_purchases', JSON.stringify(purchases));
            },

            getProgress() {
                return JSON.parse(localStorage.getItem('tm_progress') || '{}');
            },

            saveProgress(progress) {
                localStorage.setItem('tm_progress', JSON.stringify(progress));
            },

            getCurrentUser() {
                return JSON.parse(localStorage.getItem('tm_current_user') || 'null');
            },

            setCurrentUser(user) {
                localStorage.setItem('tm_current_user', JSON.stringify(user));
            },

            clearCurrentUser() {
                localStorage.removeItem('tm_current_user');
            }
        };

        // ===========================================
        // STATE
        // ===========================================

        let currentUser = DB.getCurrentUser();
        let currentCourse = null;
        let currentLesson = null;
        let selectedPaymentMethod = null;

        // ===========================================
        // SECURITY
        // ===========================================

        // Disable right-click
        document.addEventListener('contextmenu', e => e.preventDefault());

        // Block keyboard shortcuts for screenshots/dev tools
        document.addEventListener('keydown', function(e) {
            // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, PrintScreen
            if (
                e.key === 'F12' ||
                (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) ||
                (e.ctrlKey && e.key === 'u') ||
                e.key === 'PrintScreen'
            ) {
                e.preventDefault();
                showToast('Ta akcja jest zablokowana');
                return false;
            }
        });

        // Blur content on tab switch (anti-screenshot)
        document.addEventListener('visibilitychange', function() {
            const protectedContent = document.querySelector('.protected-content');
            if (protectedContent) {
                if (document.hidden) {
                    protectedContent.classList.add('blur-protection');
                } else {
                    protectedContent.classList.remove('blur-protection');
                }
            }
        });

        // Watermark movement
        let watermarkInterval;
        function startWatermark() {
            const watermark = document.getElementById('videoWatermark');
            if (!watermark || !currentUser) return;

            watermark.textContent = `ID: ${currentUser.id} | ${currentUser.email}`;

            const positions = ['top: 10%; left: 10%;', 'top: 10%; right: 10%;', 'bottom: 10%; left: 10%;', 'bottom: 10%; right: 10%;', 'top: 50%; left: 50%; transform: translate(-50%, -50%);'];
            let posIndex = 0;

            clearInterval(watermarkInterval);
            watermarkInterval = setInterval(() => {
                posIndex = (posIndex + 1) % positions.length;
                watermark.style.cssText = positions[posIndex];
            }, 5000);
        }

        // ===========================================
        // UI FUNCTIONS
        // ===========================================

        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

            // Show requested page
            const page = document.getElementById('page-' + pageName);
            if (page) {
                page.classList.add('active');
            }

            // Special handling for pages
            if (pageName === 'dashboard' && currentUser) {
                updateDashboard();
            } else if (pageName === 'admin' && (!currentUser || currentUser.role !== 'ADMIN')) {
                showPage('home');
                showToast('Brak dostepu do panelu administratora');
                return;
            } else if (pageName === 'admin') {
                updateAdminPanel();
            }

            // Scroll to top
            window.scrollTo(0, 0);
        }

        function showModal(modalName) {
            const modal = document.getElementById('modal-' + modalName);
            if (modal) {
                modal.classList.add('active');
            }
        }

        function hideModal(modalName) {
            const modal = document.getElementById('modal-' + modalName);
            if (modal) {
                modal.classList.remove('active');
            }
        }

        function showToast(message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            container.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function updateNavigation() {
            const navPublic = document.getElementById('navLinks');
            const navLoggedIn = document.getElementById('navLinksLoggedIn');
            const adminLink = document.getElementById('adminLink');
            const userEmail = document.getElementById('userEmail');

            if (currentUser) {
                navPublic.style.display = 'none';
                navLoggedIn.style.display = 'flex';
                userEmail.textContent = currentUser.email;

                if (currentUser.role === 'ADMIN') {
                    adminLink.style.display = 'inline';
                } else {
                    adminLink.style.display = 'none';
                }
            } else {
                navPublic.style.display = 'flex';
                navLoggedIn.style.display = 'none';
            }
        }

        // ===========================================
        // AUTH FUNCTIONS
        // ===========================================

        function handleLogin(e) {
            e.preventDefault();

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');

            const users = DB.getUsers();
            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                currentUser = user;
                DB.setCurrentUser(user);
                hideModal('login');
                updateNavigation();
                showToast('Zalogowano pomyslnie!');
                showPage('dashboard');
            } else {
                errorEl.textContent = 'Nieprawidlowy email lub haslo';
            }
        }

        function handleRegister(e) {
            e.preventDefault();

            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
            const errorEl = document.getElementById('registerError');

            if (password !== passwordConfirm) {
                errorEl.textContent = 'Hasla nie sa identyczne';
                return;
            }

            const users = DB.getUsers();

            if (users.find(u => u.email === email)) {
                errorEl.textContent = 'Ten email jest juz zarejestrowany';
                return;
            }

            const newUser = {
                id: 'user-' + Date.now(),
                email,
                password,
                name,
                role: 'USER',
                createdAt: new Date().toISOString().split('T')[0]
            };

            users.push(newUser);
            DB.saveUsers(users);

            currentUser = newUser;
            DB.setCurrentUser(newUser);
            hideModal('register');
            updateNavigation();
            showToast('Konto utworzone pomyslnie!');
            showPage('dashboard');
        }

        function logout() {
            currentUser = null;
            DB.clearCurrentUser();
            updateNavigation();
            showPage('home');
            showToast('Wylogowano');
        }

        // ===========================================
        // COURSE FUNCTIONS
        // ===========================================

        function showCourseDetails(courseId) {
            currentCourse = DB.courses[courseId];
            if (!currentCourse) return;

            document.getElementById('courseTitle').textContent = currentCourse.name;
            document.getElementById('paymentCourseName').textContent = currentCourse.name;
            document.getElementById('paymentCourseDesc').textContent = currentCourse.description;
            document.getElementById('paymentCoursePrice').textContent = currentCourse.price + ' PLN';

            // Check if user has purchased
            const purchases = DB.getPurchases();
            const hasPurchased = currentUser && purchases.find(p => p.userId === currentUser.id && p.courseId === courseId);

            // Update UI based on purchase status
            const videoLocked = document.getElementById('videoLocked');
            const videoPlayer = document.getElementById('videoPlayer');

            if (hasPurchased) {
                videoLocked.style.display = 'none';
                videoPlayer.style.display = 'block';
                startWatermark();
            } else {
                videoLocked.style.display = 'flex';
                videoPlayer.style.display = 'none';
            }

            // Populate lesson list
            const lessonList = document.getElementById('lessonList');
            const progress = DB.getProgress();

            lessonList.innerHTML = currentCourse.lessons.map((lesson, index) => {
                const isCompleted = progress[currentUser?.id]?.[lesson.id]?.completed;
                const isLocked = !hasPurchased && index > 0;

                return `
                    <div class="lesson-item ${isCompleted ? 'completed' : ''} ${isLocked ? 'locked' : ''}"
                         onclick="${isLocked ? 'showToast(\"Kup kurs aby odblokowaƒá\")' : `selectLesson('${lesson.id}')`}">
                        <div class="lesson-number">${isCompleted ? '‚úì' : index + 1}</div>
                        <div class="lesson-info">
                            <div class="lesson-title">${lesson.title}</div>
                            <div class="lesson-duration">${lesson.duration} ${isLocked ? 'üîí' : ''}</div>
                        </div>
                    </div>
                `;
            }).join('');

            showPage('course');
        }

        function selectLesson(lessonId) {
            const lesson = currentCourse.lessons.find(l => l.id === lessonId);
            if (!lesson) return;

            currentLesson = lesson;

            document.getElementById('currentLessonTitle').textContent = lesson.title;
            document.getElementById('currentLessonDescription').textContent = lesson.description;

            // Update active state
            document.querySelectorAll('.lesson-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // Simulate video loading
            showToast('Ladowanie lekcji: ' + lesson.title);

            // Mark lesson as in progress (for demo, we'll mark it complete after 3 seconds)
            setTimeout(() => {
                if (currentUser && currentLesson) {
                    const progress = DB.getProgress();
                    if (!progress[currentUser.id]) progress[currentUser.id] = {};
                    progress[currentUser.id][currentLesson.id] = { completed: true, completedAt: new Date().toISOString() };
                    DB.saveProgress(progress);

                    // Update UI
                    event.currentTarget.classList.add('completed');
                    event.currentTarget.querySelector('.lesson-number').textContent = '‚úì';
                }
            }, 3000);
        }

        // ===========================================
        // PAYMENT FUNCTIONS
        // ===========================================

        function selectPayment(method) {
            selectedPaymentMethod = method;

            // Update UI
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
            document.querySelector(`.payment-method input[value="${method}"]`).parentElement.classList.add('selected');

            // Show/hide inputs
            document.getElementById('blikInput').style.display = method === 'blik' ? 'block' : 'none';
            document.getElementById('cardInput').style.display = method === 'card' ? 'block' : 'none';
        }

        function processPayment() {
            if (!selectedPaymentMethod) {
                showToast('Wybierz metode platnosci');
                return;
            }

            if (!currentUser) {
                hideModal('payment');
                showModal('login');
                showToast('Zaloguj sie aby kontynuowac');
                return;
            }

            // Validate BLIK code
            if (selectedPaymentMethod === 'blik') {
                const blikCode = document.getElementById('blikCode').value;
                if (!/^\d{6}$/.test(blikCode)) {
                    showToast('Wprowadz poprawny 6-cyfrowy kod BLIK');
                    return;
                }
            }

            // Validate card
            if (selectedPaymentMethod === 'card') {
                const cardNumber = document.getElementById('cardNumber').value;
                const cardExpiry = document.getElementById('cardExpiry').value;
                const cardCvv = document.getElementById('cardCvv').value;

                if (!cardNumber || !cardExpiry || !cardCvv) {
                    showToast('Wypelnij wszystkie dane karty');
                    return;
                }
            }

            // Simulate payment processing
            showToast('Przetwarzanie platnosci...');

            setTimeout(() => {
                // Save purchase
                const purchases = DB.getPurchases();
                purchases.push({
                    id: 'purchase-' + Date.now(),
                    userId: currentUser.id,
                    courseId: currentCourse.id,
                    courseName: currentCourse.name,
                    method: selectedPaymentMethod.toUpperCase(),
                    amount: currentCourse.price,
                    status: 'completed',
                    createdAt: new Date().toISOString()
                });
                DB.savePurchases(purchases);

                hideModal('payment');
                showModal('payment-success');

                // Reset payment form
                selectedPaymentMethod = null;
                document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
                document.getElementById('blikCode').value = '';
                document.getElementById('cardNumber').value = '';
                document.getElementById('cardExpiry').value = '';
                document.getElementById('cardCvv').value = '';
            }, 2000);
        }

        // ===========================================
        // DASHBOARD FUNCTIONS
        // ===========================================

        function updateDashboard() {
            if (!currentUser) return;

            document.getElementById('dashboardUserName').textContent = currentUser.name || currentUser.email;

            const purchases = DB.getPurchases().filter(p => p.userId === currentUser.id);
            const progress = DB.getProgress()[currentUser.id] || {};

            // Stats
            document.getElementById('purchasedCoursesCount').textContent = purchases.length;

            let completedLessons = 0;
            let totalLessons = 0;

            purchases.forEach(purchase => {
                const course = DB.courses[purchase.courseId];
                if (course) {
                    totalLessons += course.lessons.length;
                    course.lessons.forEach(lesson => {
                        if (progress[lesson.id]?.completed) completedLessons++;
                    });
                }
            });

            document.getElementById('completedLessonsCount').textContent = completedLessons;
            document.getElementById('progressPercent').textContent = totalLessons > 0
                ? Math.round((completedLessons / totalLessons) * 100) + '%'
                : '0%';

            // User's courses
            const coursesContainer = document.getElementById('userCourses');
            if (purchases.length > 0) {
                coursesContainer.innerHTML = purchases.map(purchase => {
                    const course = DB.courses[purchase.courseId];
                    if (!course) return '';

                    const courseProgress = course.lessons.filter(l => progress[l.id]?.completed).length;
                    const progressPercent = Math.round((courseProgress / course.lessons.length) * 100);

                    return `
                        <div class="course-card">
                            <div class="course-image ${course.level === 'ADVANCED' ? 'advanced' : ''}">
                                ${course.level === 'ADVANCED' ? 'üöÄ' : 'üìä'}
                            </div>
                            <div class="course-content">
                                <span class="course-badge ${course.level === 'ADVANCED' ? 'badge-advanced' : 'badge-beginner'}">
                                    ${course.level === 'ADVANCED' ? 'Zaawansowany' : 'Podstawowy'}
                                </span>
                                <h3 class="course-title">${course.name}</h3>
                                <div class="course-meta">
                                    <span>Postep: ${progressPercent}%</span>
                                    <span>${courseProgress}/${course.lessons.length} lekcji</span>
                                </div>
                                <div style="background: #e2e8f0; border-radius: 10px; height: 8px; margin: 1rem 0;">
                                    <div style="background: var(--primary); border-radius: 10px; height: 100%; width: ${progressPercent}%;"></div>
                                </div>
                                <button class="btn btn-primary" onclick="showCourseDetails('${course.id}')">
                                    Kontynuuj
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                coursesContainer.innerHTML = `
                    <div class="alert alert-info">
                        Nie masz jeszcze zadnych kursow. <a href="#" onclick="showPage('home')">Przegladaj kursy</a>
                    </div>
                `;
            }

            // Payment history
            const paymentHistoryBody = document.getElementById('paymentHistoryBody');
            if (purchases.length > 0) {
                paymentHistoryBody.innerHTML = purchases.map(p => `
                    <tr>
                        <td>${new Date(p.createdAt).toLocaleDateString('pl-PL')}</td>
                        <td>${p.courseName}</td>
                        <td>${p.method}</td>
                        <td>${p.amount} PLN</td>
                        <td><span class="status-badge status-active">Zakonczona</span></td>
                    </tr>
                `).join('');
            } else {
                paymentHistoryBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; color: var(--gray);">Brak historii platnosci</td>
                    </tr>
                `;
            }
        }

        // ===========================================
        // ADMIN FUNCTIONS
        // ===========================================

        function switchAdminTab(tab) {
            // Update tabs
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.admin-tab[onclick="switchAdminTab('${tab}')"]`).classList.add('active');

            // Update content
            document.querySelectorAll('.admin-panel-content').forEach(c => c.style.display = 'none');
            document.getElementById('admin-' + tab).style.display = 'block';
        }

        function updateAdminPanel() {
            // Users table
            const users = DB.getUsers();
            const purchases = DB.getPurchases();

            document.getElementById('adminUsersTable').innerHTML = users.map(user => {
                const userPurchases = purchases.filter(p => p.userId === user.id);
                return `
                    <tr>
                        <td>${user.email}</td>
                        <td><span class="status-badge ${user.role === 'ADMIN' ? 'status-pending' : 'status-active'}">${user.role}</span></td>
                        <td>${user.createdAt}</td>
                        <td>${userPurchases.length}</td>
                        <td><span class="status-badge status-active">Aktywny</span></td>
                    </tr>
                `;
            }).join('');

            // Payments table
            document.getElementById('adminPaymentsTable').innerHTML = DB.samplePayments.map(p => `
                <tr>
                    <td>${p.date}</td>
                    <td>${p.user}</td>
                    <td>${p.course}</td>
                    <td>${p.method}</td>
                    <td>${p.amount} PLN</td>
                    <td><span class="status-badge ${p.status === 'completed' ? 'status-active' : 'status-pending'}">${p.status === 'completed' ? 'Zakonczona' : 'Oczekujaca'}</span></td>
                </tr>
            `).join('');
        }

        // ===========================================
        // RESPONSIVE LAYOUT
        // ===========================================

        function adjustLayout() {
            const courseLayout = document.querySelector('.course-layout');
            if (courseLayout && window.innerWidth < 900) {
                courseLayout.style.gridTemplateColumns = '1fr';
            } else if (courseLayout) {
                courseLayout.style.gridTemplateColumns = '2fr 1fr';
            }
        }

        window.addEventListener('resize', adjustLayout);

        // ===========================================
        // INITIALIZATION
        // ===========================================

        document.addEventListener('DOMContentLoaded', function() {
            updateNavigation();
            adjustLayout();

            // Close modals on outside click
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', function(e) {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
